#!/bin/sh

# Read the application mode from config.ini
mode=$(grep "^MODE=" config.ini | awk -F "=" '{print $2}')

root_path=$(dirname $(dirname $(realpath "$0")))

echo "make-firefox-profile: root_path = ${root_path}"

# Create a directory for the profile
#mkdir -p "${root_path}/bin/firefox/profiles/default"
mkdir --parents "${root_path}/bin/firefox/profiles"

# Create the profile that will be used by the browser
#./bin/firefox/firefox --CreateProfile "GPTProfile ${root_path}/bin/firefox/profiles/default"

echo "Setting up the default Firefox profile"
# Remove the "${root_path}/bin/firefox/profiles/default" directory and all of its
# contents
rm -rf "${root_path}/bin/firefox/profiles/default"

# Extract the default profile from the tarball
tar -xf "${root_path}/bin/default-profile.tar.xz" -C "${root_path}/bin/firefox/profiles"